<!-- pages/admin/admin.wxml -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="page-title">ç®¡ç†åå°</view>
    <view class="page-desc">æœºæ„æ•°æ®ç®¡ç†</view>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
  <view class="stats-section">
    <view class="stats-title">æ•°æ®æ¦‚è§ˆ</view>
    <view class="stats-grid">
      <view class="stats-item">
        <view class="stats-value">{{totalRecords}}</view>
        <view class="stats-label">æ€»è¯„ä¼°æ•°</view>
      </view>
      <view class="stats-item">
        <view class="stats-value">{{totalChildren}}</view>
        <view class="stats-label">è¯„ä¼°å„¿ç«¥</view>
      </view>
      <view class="stats-item">
        <view class="stats-value">{{todayRecords}}</view>
        <view class="stats-label">ä»Šæ—¥è¯„ä¼°</view>
      </view>
      <view class="stats-item">
        <view class="stats-value">{{monthRecords}}</view>
        <view class="stats-label">æœ¬æœˆè¯„ä¼°</view>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰æ¡ä»¶ -->
  <view class="filter-section">
    <view class="filter-title">ç­›é€‰æ¡ä»¶</view>
    <view class="filter-row">
      <picker mode="date" 
              value="{{filterStartDate}}" 
              bindchange="onFilterStartDateChange">
        <view class="filter-button">
          <text class="filter-text">{{filterStartDate || 'å¼€å§‹æ—¥æœŸ'}}</text>
        </view>
      </picker>
      
      <picker mode="date" 
              value="{{filterEndDate}}" 
              bindchange="onFilterEndDateChange">
        <view class="filter-button">
          <text class="filter-text">{{filterEndDate || 'ç»“æŸæ—¥æœŸ'}}</text>
        </view>
      </picker>
    </view>
    
    <view class="filter-row">
      <picker mode="selector" 
              range="{{childNames}}" 
              value="{{filterChildIndex}}"
              bindchange="onFilterChildChange">
        <view class="filter-button">
          <text class="filter-text">{{filterChildName || 'é€‰æ‹©å„¿ç«¥'}}</text>
        </view>
      </picker>
      
      <button class="filter-button" bindtap="applyFilter">
        åº”ç”¨ç­›é€‰
      </button>
    </view>
  </view>

  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="records-section">
    <view class="records-header">
      <view class="records-title">è¯„ä¼°è®°å½•</view>
      <view class="records-count">å…±{{filteredRecords.length}}æ¡è®°å½•</view>
    </view>

    <view class="records-list" wx:if="{{filteredRecords.length > 0}}">
      <view class="record-item" 
            wx:for="{{filteredRecords}}" 
            wx:key="_id"
            wx:for-item="record"
            bindtap="viewRecord"
            data-record="{{record}}">
        <view class="record-header">
          <view class="record-name">{{record.childName}}</view>
          <view class="record-date">{{record.assessmentDate}}</view>
        </view>
        
        <view class="record-summary">
          <view class="summary-item" 
                wx:for="{{record.summary}}" 
                wx:key="category"
                wx:for-item="item">
            <view class="summary-category">{{item.category}}</view>
            <view class="summary-band band-{{item.band.toLowerCase()}}">
              {{getBandName(item.band)}}
            </view>
          </view>
        </view>
        
        <view class="record-footer">
          <view class="record-time">{{formatTime(record.createdAt)}}</view>
          <view class="record-actions">
            <button class="action-button small" bindtap="generateReport" data-record="{{record}}">
              ç”ŸæˆæŠ¥å‘Š
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{filteredRecords.length === 0 && !loading}}">
      <view class="empty-icon">ğŸ“Š</view>
      <view class="empty-text">æš‚æ— æ•°æ®</view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="action-button primary" bindtap="exportAllData" loading="{{exporting}}">
      {{exporting ? 'å¯¼å‡ºä¸­...' : 'å¯¼å‡ºå…¨éƒ¨æ•°æ®'}}
    </button>
    <button class="action-button secondary" bindtap="refreshData">
      åˆ·æ–°æ•°æ®
    </button>
  </view>
</view>
