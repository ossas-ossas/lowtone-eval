# 低张儿综合功能发育量表数字化评估系统

## 项目简介

这是一款基于微信小程序开发的"低张儿综合功能发育量表"数字化评估系统，旨在为机构提供便捷的儿童发育评估工具。

## 功能特点

- 📝 **智能量表填写**：按类别分组，实时统计进度
- 📊 **可视化图表**：雷达图和柱状图展示发育水平
- 🎯 **自动评分**：智能计算各项功能发育等级
- 📋 **报告生成**：自动生成Word格式评估报告
- 👥 **多角色支持**：家长端和机构端不同权限
- 📱 **移动优先**：专为移动设备优化的用户体验

## 技术栈

- **平台**：微信小程序 + 微信云开发 CloudBase
- **前端**：原生小程序（WXML/WXSS/JS）+ 组件化结构
- **数据库**：CloudBase 数据库
- **云函数**：Node.js 18
- **图表**：ECharts for WeChat（ec-canvas）
- **报告导出**：docx-templater（Word）

## 项目结构

```
├── pages/                 # 页面文件
│   ├── home/             # 首页
│   ├── form/             # 评估表单
│   ├── preview/          # 图表预览
│   ├── submit_success/   # 提交成功
│   ├── records/          # 历史记录
│   ├── admin/            # 管理后台
│   └── detail/           # 详情页面
├── utils/                # 工具函数
│   ├── scoring.ts        # 评分逻辑
│   ├── rules.ts          # 建议规则
│   └── database.ts       # 数据库工具
├── ec-canvas/            # ECharts组件
├── cloudfunctions/       # 云函数
│   ├── getOpenId/        # 获取用户openId
│   ├── upsertSubmission/ # 保存评估数据
│   ├── getSubmission/    # 获取评估数据
│   ├── listSubmissions/  # 获取评估列表
│   ├── generateReport/    # 生成报告
│   ├── seedDictionary/   # 初始化量表数据
│   └── adminExport/      # 数据导出
├── app.js               # 小程序入口
├── app.json             # 小程序配置
└── app.wxss            # 全局样式
```

## 评估类别

系统包含10个主要评估类别：

1. **听知觉** - 听觉感知和处理能力
2. **触知觉** - 触觉感知和辨别能力
3. **视觉** - 视觉感知和识别能力
4. **前庭/本体** - 平衡和空间感知能力
5. **粗大动作** - 大肌肉群运动能力
6. **精细动作** - 小肌肉群精细操作能力
7. **社会互动** - 社交交往和沟通能力
8. **认知** - 思维和认知处理能力
9. **口腔动作** - 口腔肌肉协调能力
10. **语言** - 语言理解和表达能力

## 评分标准

系统采用四级评分标准：

- **常态 (N)** - 蓝色：分子 = 分母 (100%)
- **良好 (G)** - 绿色：分子/分母 ≥ 2/3 且 < 1 (67%-99%)
- **普通 (F)** - 黄色：分子/分母 = 1/2 ± 容差 (50%-66%)
- **差 (P)** - 红色：分子/分母 < 1/2 (<50%)

## 安装部署

### 1. 环境准备

- 安装微信开发者工具
- 注册微信小程序账号
- 开通云开发服务

### 2. 项目配置

1. 克隆项目到本地
2. 在微信开发者工具中导入项目
3. 配置云开发环境ID
4. 上传云函数到云端

### 3. 数据库初始化

```javascript
// 调用云函数初始化量表数据
wx.cloud.callFunction({
  name: 'seedDictionary',
  success: res => {
    console.log('量表数据初始化成功', res);
  }
});
```

### 4. 权限配置

- 配置数据库权限
- 设置云存储权限
- 配置云函数权限

## 使用说明

### 家长端使用流程

1. **登录**：使用微信登录系统
2. **填写信息**：输入儿童基本信息和评估日期
3. **量表评估**：按类别逐项填写量表题目
4. **查看结果**：系统自动计算并展示评估结果
5. **生成报告**：下载详细的评估报告

### 机构端使用流程

1. **登录**：使用机构账号登录
2. **数据管理**：查看所有用户的评估记录
3. **筛选导出**：按条件筛选并导出数据
4. **报告生成**：为任意评估记录生成报告

## 开发说明

### 评分逻辑

评分逻辑位于 `utils/scoring.ts`，包含：

- `ratioToBand()` - 比例转分档
- `summarizeByCategory()` - 按类别汇总
- `calculateOverallLevel()` - 计算总体水平

### 建议规则

建议规则位于 `utils/rules.ts`，包含：

- `buildAdvice()` - 构建基础建议
- `generatePersonalizedAdvice()` - 生成个性化建议

### 图表配置

图表使用ECharts实现，支持：

- 雷达图展示各功能发育水平
- 柱状图显示具体比例数据
- 交互式tooltip显示详细信息

## 注意事项

1. **数据安全**：所有敏感数据加密传输
2. **权限控制**：家长只能查看自己的数据
3. **报告有效期**：报告链接有效期30天
4. **使用限制**：年使用次数建议不超过1000次

## 更新日志

### v1.0.0 (2025-01-XX)

- 初始版本发布
- 支持完整的评估流程
- 实现报告生成功能
- 支持多角色权限管理

## 技术支持

如有问题或建议，请联系开发团队。

## 许可证

MIT License
